
üìÇ –ü–∞–ø–∫–∞: ./

üìÑ –§–∞–π–ª: api.js
============================================================
const API_BASE = process.env.REACT_APP_API_BASE || "http://localhost:8000";

// üîπ –û–±—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞
async function request(endpoint, options = {}) {
  const response = await fetch(`${API_BASE}${endpoint}`, options);
  if (!response.ok) {
    const error = await response.json().catch(() => ({ detail: "–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞" }));
    throw error;
  }
  return response.json();
}

// üîπ –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
export async function fetchUsers() {
  const response = await fetch(`${API_BASE}/users`);
  if (!response.ok) {
    const error = await response.json().catch(() => ({ detail: "–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞" }));
    throw error;
  }
  return await response.json();
}

// üîπ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
export async function login(user_id, password) {
  return request("/login", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ user_id, password }),
  });
}

// üîπ –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —á–µ–∫-–ª–∏—Å—Ç—ã
export async function fetchChecklists() {
  return request("/checklists");
}

// üîπ –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç –ø–æ ID
export async function fetchChecklist(id) {
  return request(`/checklists/${id}`);
}

// üîπ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç—á—ë—Ç
export async function submitReport(payload) {
  return request("/submit_report", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload),
  });
}

============================================================

üìÑ –§–∞–π–ª: index.js
============================================================
import React from "react";
import ReactDOM from "react-dom/client";
import App from "./App";
import "./index.css";

// ‚úÖ –ü–æ–¥–∫–ª—é—á–∞–µ–º PWA (service worker)
import * as serviceWorkerRegistration from "./serviceWorkerRegistration";

// ‚úÖ (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) –ª–æ–≥–∏—Ä—É–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
import reportWebVitals from "./reportWebVitals";

const root = ReactDOM.createRoot(document.getElementById("root"));

root.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);

// ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º service worker –¥–ª—è PWA
serviceWorkerRegistration.register();

// ‚úÖ –í–∫–ª—é—á–∞–µ–º –æ—Ç—á—ë—Ç –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å)
reportWebVitals();

============================================================

üìÑ –§–∞–π–ª: App.js
============================================================
import React, { useState, useEffect } from "react";
import LoginSelect from "./components/LoginSelect";
import Dashboard from "./components/Dashboard";
import ChecklistPlayer from "./components/ChecklistPlayer";

function App() {
  const [user, setUser] = useState(null);
  const [currentChecklist, setCurrentChecklist] = useState(null);
  const [backendStatus, setBackendStatus] = useState("‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞...");

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å backend
  useEffect(() => {
    fetch("/ping")   // ‚ö° —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ proxy
      .then((res) => res.json())
      .then((data) => setBackendStatus("‚úÖ Backend —Ä–∞–±–æ—Ç–∞–µ—Ç: " + data.message))
      .catch((err) =>
        setBackendStatus("‚ùå –û—à–∏–±–∫–∞ fetch: " + err.message)
      );
  }, []);

  if (!user) {
    return (
      <div>
        <p>{backendStatus}</p>
        <LoginSelect onLogin={(u) => setUser(u)} />
      </div>
    );
  }

  if (currentChecklist) {
    return (
      <ChecklistPlayer
        user={user}
        checklistId={currentChecklist}
        onDone={() => {
          setCurrentChecklist(null);
          setUser(null);
          alert("–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è.");
        }}
      />
    );
  }

  return (
    <div>
      <p>{backendStatus}</p>
      <Dashboard user={user} onOpenChecklist={(id) => setCurrentChecklist(id)} />
    </div>
  );
}

export default App;

============================================================

üìÑ –§–∞–π–ª: serviceWorkerRegistration.js
============================================================
// ‚úÖ serviceWorkerRegistration.js

const isLocalhost = Boolean(
  window.location.hostname === "localhost" ||
  window.location.hostname === "[::1]" ||
  window.location.hostname.match(
    /^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/
  )
);

export function register(config) {
  if ("serviceWorker" in navigator) {
    window.addEventListener("load", () => {
      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;

      if (isLocalhost) {
        // ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ service worker –Ω–∞ localhost
        checkValidServiceWorker(swUrl, config);
      } else {
        // ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è service worker –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
        registerValidSW(swUrl, config);
      }
    });
  }
}

function registerValidSW(swUrl, config) {
  navigator.serviceWorker
    .register(swUrl)
    .then(registration => {
      registration.onupdatefound = () => {
        const installingWorker = registration.installing;
        if (installingWorker == null) return;

        installingWorker.onstatechange = () => {
          if (installingWorker.state === "installed") {
            if (navigator.serviceWorker.controller) {
              console.log("üîÑ –ù–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ.");
              if (config && config.onUpdate) config.onUpdate(registration);
            } else {
              console.log("‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω –¥–ª—è –æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–∞.");
              if (config && config.onSuccess) config.onSuccess(registration);
            }
          }
        };
      };
    })
    .catch(error => {
      console.error("‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ service worker:", error);
    });
}

function checkValidServiceWorker(swUrl, config) {
  fetch(swUrl, { headers: { "Service-Worker": "script" } })
    .then(response => {
      const contentType = response.headers.get("content-type");
      if (
        response.status === 404 ||
        (contentType != null && contentType.indexOf("javascript") === -1)
      ) {
        navigator.serviceWorker.ready.then(registration => {
          registration.unregister().then(() => {
            window.location.reload();
          });
        });
      } else {
        registerValidSW(swUrl, config);
      }
    })
    .catch(() => {
      console.log("‚ö†Ô∏è –ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–µ.");
    });
}

export function unregister() {
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.ready
      .then(registration => {
        registration.unregister();
      })
      .catch(error => {
        console.error("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ service worker:", error);
      });
  }
}

============================================================

üìÑ –§–∞–π–ª: reportWebVitals.js
============================================================
// reportWebVitals.js ‚Äî –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
const reportWebVitals = onPerfEntry => {
  if (onPerfEntry && onPerfEntry instanceof Function) {
    import("web-vitals").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {
      getCLS(onPerfEntry);
      getFID(onPerfEntry);
      getFCP(onPerfEntry);
      getLCP(onPerfEntry);
      getTTFB(onPerfEntry);
    });
  }
};

export default reportWebVitals;

============================================================

üìÑ –§–∞–π–ª: index.css
============================================================
/* üîπ –û–±—â–∏–µ —Å—Ç–∏–ª–∏ */
* {
  box-sizing: border-box;
}

body {
  margin: 0;
  padding: 0;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  background-color: #f5f5f5;
  color: #333;
  line-height: 1.5;
}

/* üîπ –ó–∞–≥–æ–ª–æ–≤–∫–∏ */
h1, h2, h3 {
  margin: 0 0 10px;
  font-weight: 600;
}

/* üîπ –ö–Ω–æ–ø–∫–∏ */
button {
  font-family: inherit;
  font-size: 1em;
  padding: 10px 16px;
  border: none;
  border-radius: 8px;
  background-color: #007bff;
  color: white;
  cursor: pointer;
  transition: background 0.3s ease;
}

button:hover {
  background-color: #0056b3;
}

/* üîπ –ü–æ–ª—è –≤–≤–æ–¥–∞ */
input, textarea {
  font-family: inherit;
  font-size: 1em;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 6px;
  width: 100%;
  margin-bottom: 10px;
}

/* üîπ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è */
#root {
  padding: 20px;
  max-width: 640px;
  margin: auto;
}

/* üîπ –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
@media (max-width: 480px) {
  button {
    width: 100%;
    font-size: 0.95em;
  }

  input, textarea {
    font-size: 0.95em;
  }
}

============================================================

üìÑ –§–∞–π–ª: dump_structure.py
============================================================
import os

output_file = "project_structure.txt"

def dump_directory(root_dir, output_file):
    with open(output_file, "w", encoding="utf-8") as out:
        for foldername, subfolders, filenames in os.walk(root_dir):
            # –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å
            rel_path = os.path.relpath(foldername, root_dir)
            if rel_path == ".":
                rel_path = ""
            out.write(f"\nüìÇ –ü–∞–ø–∫–∞: {rel_path or './'}\n")

            for filename in filenames:
                filepath = os.path.join(foldername, filename)
                out.write(f"\nüìÑ –§–∞–π–ª: {os.path.join(rel_path, filename)}\n")
                out.write("=" * 60 + "\n")
                try:
                    with open(filepath, "r", encoding="utf-8", errors="ignore") as f:
                        content = f.read()
                    out.write(content + "\n")
                except Exception as e:
                    out.write(f"[–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞: {e}]\n")
                out.write("=" * 60 + "\n")
    print(f"‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ {output_file}")

if __name__ == "__main__":
    dump_directory(os.getcwd(), output_file)

============================================================

üìÑ –§–∞–π–ª: project_structure.txt
============================================================

üìÇ –ü–∞–ø–∫–∞: ./

üìÑ –§–∞–π–ª: api.js
============================================================
const API_BASE = process.env.REACT_APP_API_BASE || "http://localhost:8000";

// üîπ –û–±—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞
async function request(endpoint, options = {}) {
  const response = await fetch(`${API_BASE}${endpoint}`, options);
  if (!response.ok) {
    const error = await response.json().catch(() => ({ detail: "–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞" }));
    throw error;
  }
  return response.json();
}

// üîπ –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
export async function fetchUsers() {
  const response = await fetch(`${API_BASE}/users`);
  if (!response.ok) {
    const error = await response.json().catch(() => ({ detail: "–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞" }));
    throw error;
  }
  return await response.json();
}

// üîπ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
export async function login(user_id, password) {
  return request("/login", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ user_id, password }),
  });
}

// üîπ –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —á–µ–∫-–ª–∏—Å—Ç—ã
export async function fetchChecklists() {
  return request("/checklists");
}

// üîπ –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç –ø–æ ID
export async function fetchChecklist(id) {
  return request(`/checklists/${id}`);
}

// üîπ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç—á—ë—Ç
export async function submitReport(payload) {
  return request("/submit_report", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload),
  });
}

============================================================

üìÑ –§–∞–π–ª: index.js
============================================================
import React from "react";
import ReactDOM from "react-dom/client";
import App from "./App";
import "./index.css";

// ‚úÖ –ü–æ–¥–∫–ª—é—á–∞–µ–º PWA (service worker)
import * as serviceWorkerRegistration from "./serviceWorkerRegistration";

// ‚úÖ (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) –ª–æ–≥–∏—Ä—É–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
import reportWebVitals from "./reportWebVitals";

const root = ReactDOM.createRoot(document.getElementById("root"));

root.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);

// ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º service worker –¥–ª—è PWA
serviceWorkerRegistration.register();

// ‚úÖ –í–∫–ª—é—á–∞–µ–º –æ—Ç—á—ë—Ç –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å)
reportWebVitals();

============================================================

üìÑ –§–∞–π–ª: App.js
============================================================
import React, { useState, useEffect } from "react";
import LoginSelect from "./components/LoginSelect";
import Dashboard from "./components/Dashboard";
import ChecklistPlayer from "./components/ChecklistPlayer";

function App() {
  const [user, setUser] = useState(null);
  const [currentChecklist, setCurrentChecklist] = useState(null);
  const [backendStatus, setBackendStatus] = useState("‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞...");

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å backend
  useEffect(() => {
    fetch("/ping")   // ‚ö° —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ proxy
      .then((res) => res.json())
      .then((data) => setBackendStatus("‚úÖ Backend —Ä–∞–±–æ—Ç–∞–µ—Ç: " + data.message))
      .catch((err) =>
        setBackendStatus("‚ùå –û—à–∏–±–∫–∞ fetch: " + err.message)
      );
  }, []);

  if (!user) {
    return (
      <div>
        <p>{backendStatus}</p>
        <LoginSelect onLogin={(u) => setUser(u)} />
      </div>
    );
  }

  if (currentChecklist) {
    return (
      <ChecklistPlayer
        user={user}
        checklistId={currentChecklist}
        onDone={() => {
          setCurrentChecklist(null);
          setUser(null);
          alert("–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è.");
        }}
      />
    );
  }

  return (
    <div>
      <p>{backendStatus}</p>
      <Dashboard user={user} onOpenChecklist={(id) => setCurrentChecklist(id)} />
    </div>
  );
}

export default App;

============================================================

üìÑ –§–∞–π–ª: serviceWorkerRegistration.js
============================================================
// ‚úÖ serviceWorkerRegistration.js

const isLocalhost = Boolean(
  window.location.hostname === "localhost" ||
  window.location.hostname === "[::1]" ||
  window.location.hostname.match(
    /^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/
  )
);

export function register(config) {
  if ("serviceWorker" in navigator) {
    window.addEventListener("load", () => {
      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;

      if (isLocalhost) {
        // ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ service worker –Ω–∞ localhost
        checkValidServiceWorker(swUrl, config);
      } else {
        // ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è service worker –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
        registerValidSW(swUrl, config);
      }
    });
  }
}

function registerValidSW(swUrl, config) {
  navigator.serviceWorker
    .register(swUrl)
    .then(registration => {
      registration.onupdatefound = () => {
        const installingWorker = registration.installing;
        if (installingWorker == null) return;

        installingWorker.onstatechange = () => {
          if (installingWorker.state === "installed") {
            if (navigator.serviceWorker.controller) {
              console.log("üîÑ –ù–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ.");
              if (config && config.onUpdate) config.onUpdate(registration);
            } else {
              console.log("‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω –¥–ª—è –æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–∞.");
              if (config && config.onSuccess) config.onSuccess(registration);
            }
          }
        };
      };
    })
    .catch(error => {
      console.error("‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ service worker:", error);
    });
}

function checkValidServiceWorker(swUrl, config) {
  fetch(swUrl, { headers: { "Service-Worker": "script" } })
    .then(response => {
      const contentType = response.headers.get("content-type");
      if (
        response.status === 404 ||
        (contentType != null && contentType.indexOf("javascript") === -1)
      ) {
        navigator.serviceWorker.ready.then(registration => {
          registration.unregister().then(() => {
            window.location.reload();
          });
        });
      } else {
        registerValidSW(swUrl, config);
      }
    })
    .catch(() => {
      console.log("‚ö†Ô∏è –ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–µ.");
    });
}

export function unregister() {
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.ready
      .then(registration => {
        registration.unregister();
      })
      .catch(error => {
        console.error("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ service worker:", error);
      });
  }
}

============================================================

üìÑ –§–∞–π–ª: reportWebVitals.js
============================================================
// reportWebVitals.js ‚Äî –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
const reportWebVitals = onPerfEntry => {
  if (onPerfEntry && onPerfEntry instanceof Function) {
    import("web-vitals").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {
      getCLS(onPerfEntry);
      getFID(onPerfEntry);
      getFCP(onPerfEntry);
      getLCP(onPerfEntry);
      getTTFB(onPerfEntry);
    });
  }
};

export default reportWebVitals;

============================================================

üìÑ –§–∞–π–ª: index.css
============================================================
/* üîπ –û–±—â–∏–µ —Å—Ç–∏–ª–∏ */
* {
  box-sizing: border-box;
}

body {
  margin: 0;
  padding: 0;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  background-color: #f5f5f5;
  color: #333;
  line-height: 1.5;
}

/* üîπ –ó–∞–≥–æ–ª–æ–≤–∫–∏ */
h1, h2, h3 {
  margin: 0 0 10px;
  font-weight: 600;
}

/* üîπ –ö–Ω–æ–ø–∫–∏ */
button {
  font-family: inherit;
  font-size: 1em;
  padding: 10px 16px;
  border: none;
  border-radius: 8px;
  background-color: #007bff;
  color: white;
  cursor: pointer;
  transition: background 0.3s ease;
}

button:hover {
  background-color: #0056b3;
}

/* üîπ –ü–æ–ª—è –≤–≤–æ–¥–∞ */
input, textarea {
  font-family: inherit;
  font-size: 1em;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 6px;
  width: 100%;
  margin-bottom: 10px;
}

/* üîπ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è */
#root {
  padding: 20px;
  max-width: 640px;
  margin: auto;
}

/* üîπ –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
@media (max-width: 480px) {
  button {
    width: 100%;
    font-size: 0.95em;
  }

  input, textarea {
    font-size: 0.95em;
  }
}


============================================================

üìÇ –ü–∞–ø–∫–∞: components

üìÑ –§–∞–π–ª: components/LoginSelect.js
============================================================
import React, { useState, useEffect } from "react";
import { fetchUsers, login } from "../api"; // —É–±–µ–¥–∏—Å—å, —á—Ç–æ –ø—É—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

export default function LoginSelect({ onLogin }) {
  const [users, setUsers] = useState([]);
  const [userId, setUserId] = useState("");
  const [password, setPassword] = useState("");
  const [error, setError] = useState("");

  useEffect(() => {
    fetchUsers()
      .then(setUsers)
      .catch(err => {
        console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:", err);
        setError("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π");
      });
  }, []);

  const handleLogin = async () => {
    setError("");
    try {
      await login(Number(userId), password);
      const user = users.find(u => u.id === Number(userId));
      onLogin(user);
    } catch (e) {
      setError(e.detail || "–û—à–∏–±–∫–∞ –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è");
    }
  };

  return (
    <div style={{ padding: 20 }}>
      <h2>–í—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>

      <select value={userId} onChange={e => setUserId(e.target.value)}>
        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</option>
        {users.map(user => (
          <option key={user.id} value={user.id}>
            {user.name}
          </option>
        ))}
      </select>

      <input
        type="password"
        placeholder="–ü–∞—Ä–æ–ª—å"
        value={password}
        onChange={e => setPassword(e.target.value)}
      />

      {error && <div style={{ color: "red" }}>{error}</div>}

      <button onClick={handleLogin}>–í–æ–π—Ç–∏</button>
    </div>
  );
}

============================================================

üìÑ –§–∞–π–ª: components/Dashboard.js
============================================================
import React, {useEffect, useState} from "react";
import { fetchChecklists } from "../api";

export default function Dashboard({user, onOpenChecklist}) {
  const [cls, setCls] = useState([]);
  useEffect(()=> {
    fetchChecklists().then(setCls);
  }, []);
  return (
    <div style={{padding:20}}>
      <h2>–ü—Ä–∏–≤–µ—Ç, {user.name}</h2>
      <h3>–ß–µ–∫-–ª–∏—Å—Ç—ã</h3>
      <ul>
        {cls.map(c => (
          <li key={c.id}>
            <button onClick={()=>onOpenChecklist(c.id)}>{c.title}</button>
          </li>
        ))}
      </ul>
    </div>
  );
}

============================================================

üìÑ –§–∞–π–ª: components/ChecklistPlayer.js
============================================================
import React, { useEffect, useState } from "react";
import { fetchChecklist, submitReport } from "../api";
import "./ChecklistPlayer.css";

export default function ChecklistPlayer({ user, checklistId, onDone }) {
  const [checklist, setChecklist] = useState(null);
  const [index, setIndex] = useState(0);
  const [checkedIds, setCheckedIds] = useState([]);
  const [comment, setComment] = useState("");
  const [showTemplate, setShowTemplate] = useState(false);
  const [meta, setMeta] = useState({
    date_of_incident: "",
    flight_number: "",
    place: "",
    time_of_incident: ""
  });

  const [reportTime, setReportTime] = useState("");

  useEffect(() => {
    fetchChecklist(checklistId).then(data => {
      setChecklist(data);
      setReportTime(new Date().toISOString().slice(0, 16)); // YYYY-MM-DDTHH:mm
    });
    setIndex(0);
    setCheckedIds([]);
    setComment("");
    setShowTemplate(false);
  }, [checklistId]);

  if (!checklist) return <div className="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —á–µ–∫-–ª–∏—Å—Ç–∞...</div>;

  const items = checklist.items;
  const current = items[index];
  const progress = Math.round((checkedIds.length / items.length) * 100);
  const skippedItems = items.filter(item => !checkedIds.includes(item.id)).map(item => item.text);

  const markChecked = (id) => {
    if (!checkedIds.includes(id)) setCheckedIds([...checkedIds, id]);
  };

  const uncheck = (id) => {
    setCheckedIds(checkedIds.filter(i => i !== id));
  };

  const skip = () => setIndex(i => Math.min(items.length - 1, i + 1));
  const back = () => setIndex(i => Math.max(0, i - 1));
  const toggleTemplate = () => setShowTemplate(prev => !prev);

  const onNextAfterCheck = () => {
    markChecked(current.id);
    if (index < items.length - 1) setIndex(index + 1);
  };

  const handleSubmit = async () => {
    if (!meta.date_of_incident || !meta.time_of_incident) {
      alert("‚úã –£–∫–∞–∂–∏—Ç–µ –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è");
      return;
    }

    const payload = {
      user_id: user.id,
      checklist_id: checklist.id,
      date_of_incident: meta.date_of_incident,
      flight_number: meta.flight_number,
      place: meta.place,
      time_of_incident: meta.time_of_incident,
      checked_item_ids: checkedIds,
      comment,
      report_time: reportTime
    };

    try {
      await submitReport(payload);
      alert("üì§ –û—Ç—á—ë—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω");
      onDone();
    } catch (e) {
      alert("‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏");
    }
  };

  return (
    <div className="checklist-player">
      <h2>{checklist.title}</h2>

      <div className="progress-bar">
        <div className="progress-fill" style={{ width: `${progress}%` }} />
        <span className="progress-text">{progress}% –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</span>
      </div>

      <div className="checklist-item">
        <strong>–ü—É–Ω–∫—Ç {index + 1} / {items.length}</strong>
        <p>{current.text}</p>
      </div>

      <div className="checklist-controls">
        <button onClick={back}>‚óÄ –ù–ê–ó–ê–î</button>
        <button onClick={skip}>‚ñ∂ –î–ê–õ–ï–ï</button>
      </div>

      <div className="checklist-controls">
        <button onClick={onNextAfterCheck}>‚úÖ –í–´–ü–û–õ–ù–ï–ù–û</button>
        <button onClick={() => uncheck(current.id)}>‚õî –û–¢–ú–ï–ù–ò–¢–¨</button>
      </div>

      <div className="checklist-template">
        <button onClick={toggleTemplate}>üìÑ –®–ê–ë–õ–û–ù</button>
        {showTemplate && (
          <div className="template-text">
            <p>üîπ –®–∞–±–ª–æ–Ω –¥–ª—è —á–µ–∫-–ª–∏—Å—Ç–∞: {checklist.title}</p>
            <p>{checklist.template_text || "‚ùå –®–∞–±–ª–æ–Ω –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"}</p>
          </div>
        )}
      </div>

      {index === items.length - 1 && (
        <div className="report-form">
          <h4>üìã –§–æ—Ä–º–∞ –æ—Ç—á—ë—Ç–∞</h4>
          <input type="text" placeholder="‚úàÔ∏è –†–µ–π—Å" value={meta.flight_number} onChange={e => setMeta({ ...meta, flight_number: e.target.value })} />
          <input type="text" placeholder="üìç –†–∞–π–æ–Ω/–ó–æ–Ω–∞" value={meta.place} onChange={e => setMeta({ ...meta, place: e.target.value })} />
          <input type="date" value={meta.date_of_incident} onChange={e => setMeta({ ...meta, date_of_incident: e.target.value })} />
          <input type="time" value={meta.time_of_incident} onChange={e => setMeta({ ...meta, time_of_incident: e.target.value })} />
          <textarea placeholder="üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π" value={comment} onChange={e => setComment(e.target.value)} />
          <button onClick={handleSubmit}>üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç—á—ë—Ç</button>
        </div>
      )}

      <div className="checklist-status">
        <p>‚úÖ –û—Ç–º–µ—á–µ–Ω–æ: {checkedIds.length} / {items.length}</p>
        <p>üïí –ó–∞–ø–æ–ª–Ω–µ–Ω–æ: {reportTime.replace("T", " ")}</p>
        {skippedItems.length > 0 && (
          <p>‚ö†Ô∏è –ü—Ä–æ–ø—É—â–µ–Ω–æ: {skippedItems.join(", ")}</p>
        )}
      </div>
    </div>
  );
}

============================================================

üìÑ –§–∞–π–ª: components/ChecklistPlayer.css
============================================================
.checklist-player {
  padding: 20px;
  max-width: 640px;
  margin: auto;
  font-family: sans-serif;
}

.progress-bar {
  position: relative;
  height: 20px;
  background: #e0e0e0;
  border-radius: 10px;
  margin-bottom: 20px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: #28a745;
  transition: width 0.3s ease;
}

.progress-text {
  position: absolute;
  top: -25px;
  right: 0;
  font-size: 0.9em;
  color: #333;
}

.checklist-item {
  background: #f9f9f9;
  padding: 15px;
  border-radius: 8px;
  margin-bottom: 20px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

.checklist-controls {
  display: flex;
  gap: 10px;
  justify-content: center;
  margin-bottom: 10px;
}

.checklist-controls button {
  flex: 1 1 45%;
  padding: 12px;
  font-size: 1em;
  border: 2px solid #007bff;
  border-radius: 8px;
  background-color: white;
  color: #007bff;
  cursor: pointer;
  transition: background 0.3s ease;
}

.checklist-controls button:hover {
  background-color: #007bff;
  color: white;
}

.checklist-template {
  text-align: center;
  margin-bottom: 20px;
}

.template-text {
  background: #fff8dc;
  padding: 10px;
  border-radius: 6px;
  margin-top: 10px;
  font-size: 0.95em;
}

.report-form {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-top: 20px;
}

.report-form input,
.report-form textarea {
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 6px;
  font-size: 1em;
}

.report-form button {
  padding: 12px;
  background-color: #28a745;
  color: white;
  border: none;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
}

.report-form button:hover {
  background-color: #218838;
}

.checklist-status {
  margin-top: 20px;
  text-align: left;
}

============================================================
